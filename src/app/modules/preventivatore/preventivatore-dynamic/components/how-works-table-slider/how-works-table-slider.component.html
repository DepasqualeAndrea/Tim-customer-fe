<div class="container how-work-table-slider-container" data-cy="how-work-table-slider__container"
  [ngClass]="data.container_class">
  <div class="row">
    <div id="advantages" class="col-12">
      <h2>{{data.title_section}}</h2>
      <div class="how-works-description" [innerHTML]="data.text_section" *ngIf="data.text_section"></div>
      <div class="how-works-link" [innerHTML]="data.table_combinations" *ngIf="data.table_combinations"></div>
      <!-- Mobile version with slider -->
      <ngb-carousel class="d-block d-md-none row" #carousel (swipe)="onSwipe($event)"
        data-mc-options='{ "touchAction": "pan-y" }'>
        <ng-template ngbSlide
          *ngFor="let product of data.product_content; let i=index; let first = first; let last = last"
          [id]="product.product_code">
          <div class="slider-container col-12">
            <div class="col-1 order-1 fake-table" [ngClass]="{'left': !first && animationState != 'slideRight'}"></div>
            <div class="carousel-table col-10 order-2" [@animator]="animationState"
              (@animator.done)="resetAnimationState()">
              <div class="bg-circle-cards"></div>
              <h3 class="product-title" [innerHTML]="product.name"></h3>
              <div *ngIf="product.recommended" class="ribbon"><span>consigliato</span></div>
              <div *ngIf="product.included" class="ribbon"><span>incluso</span></div>
              <div *ngIf="product.included && product.product_code ==='coverage-card'" class="ribbon"><span>{{data.ribbon}}</span></div>
              <ul class="item-list">
                <ng-container *ngFor="let item of product.items_list">
                  <div [ngClass]="{ 'title': item.title}" class="list-text pr-3">
                    <p [ngClass]="{'tooltip': !item.tooltip}"
                      class="info-tooltip baloon info-char position-absolute rounded-circle p-0 font-weight-bold"
                      placement="left auto" ngbPopover="{{item.info}}">i
                    </p>
                    <li [ngClass]="{'included': item.included}" class="primary-item" [innerHtml]="item.text"></li>
                  </div>
                  <ng-template
                    *ngIf="item.subitems.length && item.subitems_list; then subitemIncluded else subitemTextOnly">
                  </ng-template>
                  <ng-template #subitemTextOnly>
                    <ul class="subitems-list" *ngIf="item.subitems.length">
                      <li *ngFor="let subitem of item.subitems">{{subitem}}</li>
                    </ul>
                  </ng-template>
                  <ng-template #subitemIncluded>
                    <div [ngClass]="subitem.included ? 'subitems-included' : 'subitems-excluded'"
                      *ngFor="let subitem of item.subitems" [innerHtml]="subitem.text"></div>
                  </ng-template>
                </ng-container>
              </ul>
            </div>
            <div class="col-1 order-3 fake-table" [ngClass]="{'right': !last && animationState != 'slideLeft'}"></div>
          </div>
        </ng-template>
      </ngb-carousel>
      <!-- Dekstop version no slider -->
      <div class="d-none d-md-flex row">
        <div *ngFor="let product of data.product_content" class="col">
          <div class="carousel-table">
            <div class="bg-circle-cards"></div>
            <h3 class="product-title" [innerHTML]="product.name"></h3>
            <div *ngIf="product.recommended" class="ribbon"><span>consigliato</span></div>
            <div *ngIf="product.included" class="ribbon"><span>incluso</span></div>
            <div *ngIf="product.ribbon" class="ribbon"><span>{{product.ribbon}}</span></div>
            <div *ngIf="product.included && product.product_code ==='coverage-card'" class="ribbon"><span>{{data.ribbon}}</span></div>
            <ul class="item-list">
              <ng-container *ngFor="let item of product.items_list">
                <div [ngClass]="{ 'title': item.title, 'subtitle': item.sub_title}" class="list-text pr-3">
                  <p [ngClass]="{'tooltip': !item.tooltip}"
                    class="info-tooltip baloon info-char position-absolute rounded-circle p-0 font-weight-bold"
                    placement="left" ngbTooltip="{{item.info}}">i
                  </p>
                  <li [ngClass]="{'included': item.included}" class="primary-item" [innerHtml]="item.text"></li>
                </div>
                <ng-template
                  *ngIf="item.subitems.length && item.subitems_list; then subitemIncluded else subitemTextOnly">
                </ng-template>
                <ng-template #subitemTextOnly>
                  <ul class="subitems-list" *ngIf="item.subitems.length">
                    <li *ngFor="let subitem of item.subitems">{{subitem}}</li>
                  </ul>
                </ng-template>
                <ng-template #subitemIncluded>
                  <div [ngClass]="subitem.included ? 'subitems-included' : 'subitems-excluded'"
                    *ngFor="let subitem of item.subitems" [innerHtml]="subitem.text"></div>
                </ng-template>
              </ng-container>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
